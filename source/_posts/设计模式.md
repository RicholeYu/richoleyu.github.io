---
title: 设计模式
date: 2019-10-31 17:51:08
tags: Javascript
---
## Javascript 设计模式汇总
### 工厂模式/构造器模式
* React.createElement()
* $('body')
```javascript
function factory () {
    let object = {}
    object.name = 'factory'
    object.hello = () => console.log(`Hello ${object.name}`)
    return object
}

var obj = factory()
obj.hello()

function factory1 () {
    this.name = 'factory1'
    this.hello = () => console.log(`Hello ${this.name}`)
}

var obj1 = new factory1()
obj1.hello()
```
  
### 单例模式
* redux store.getState() redux的单一数据源, 整个应用的state被存储在一个Object tree中
```javascript
const instance = (() => {
    let obj = null
    return () => obj ? obj : obj = {
        name: 'instance',
        hello: () => console.log(`Hello ${obj.name}`)
    }
})()
var instanceObj = instance()
instanceObj.hello()
```
  
### 模块化模式
```javascript
const module = (function () {
    const private = {}
    const dosomething = () => {}
    const dosomething1 = () => {}
    return {
        dosomething,
        dosomething1
    }
})()

// 导入模式
const module1 = (function (jq, _) {
    const private = {}
    const dosomething = () => {}
    const dosomething1 = () => {}
    return {
        dosomething,
        dosomething1
    }
})(jq, _)

// 导出模式
const module3 = (function () {
    const dosomething = () => {}
    const dosomething1 = () => {}
    const private = {
        dosomething,
        dosomething1
    }
    return private
})()

```

### 观察者模式
```javascript
function Observer (text = '') {
    this.update = function () {
        console.log(text || "do something")
    }
}

function Subject () {
    this.observerList = []
    this.addObserver = function (observer) {
        this.observerList.push(observer)
    }
    this.notify = function () {
        this.observerList.map(observer => observer.update())
    }
}

let subject = new Subject()
let observer = new Observer()
let observer1 = new Observer("working")
subject.addObserver(observer)
subject.addObserver(observer1)
subject.notify()
```

### 发布/订阅模式
```javascript
const pubsub = (() => {
    const topics = {}
    
    function subscribe (topic, fn) {
        if (!topics[topic]) {
            topics[topic] = []
        }
        topics[topic].push(fn)
    }
    
    function publish (topic, ...args) {
        if (!topics[topic]) {
            return
        }
        for (let fn of topics[topic]) {
            fn(...args)
        }
    }
    
    return {
        subscribe,
        publish
    }
})()

pubsub.subscribe('React', function (a) {
    console.log(a)
})
pubsub.subscribe('React', function (a, b) {
    console.log(a, b)
})
pubsub.subscribe('Vue', function (a) {
    console.log(a)
})

pubsub.publish('React', 'React Hook', 'React fiber')
pubsub.publish('Vue', "Vue3.0 is comming")
```
  
### Mixin模式
```javascript
function Person (firstname, lastname) {
    this.firstname = firstname
    this.lastname = lastname
}
Person.prototype.who = function () {
    console.log(`this is ${this.firstname} ${this.lastname}`)
}

function Superhero (firstname, lastname, powers) {
    Person.call(this, firstname, lastname)
    this.powers = powers
}

Superhero.prototype = Object.assign({}, Person.prototype)

var superhero = new Superhero("Jon", "Snow", ['King of the north', 'House Targaryen'])
superhero.who()
```
